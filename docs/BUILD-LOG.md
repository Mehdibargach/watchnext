# BUILD LOG — WatchNext

| Date | Phase | What | Details |
|------|-------|------|---------|
| 2026-02-19 | FRAME | 1-Pager written | Problem: decision fatigue + platform-locked recs. Solution: mood → TMDB filters → 5 movies. Riskiest Assumption: "LLM can translate vague mood into useful TMDB filters." 3-level eval framework defined: Filter Accuracy (deterministic), Constraint Compliance (deterministic), Rec Relevance (semi-subjective). |
| 2026-02-19 | FRAME | BUILD Gameplan written | Walking Skeleton (5 micro-tests) → Scope 1 (watch providers + ranking + explanations, 6 tests) → Scope 2 (deploy + Lovable, 8 tests). DOR/DOD per slice. |
| 2026-02-19 | BUILD | Walking Skeleton — code | Created `api.py` (FastAPI, /health + /recommend), `core/mood_parser.py` (GPT-4o-mini function calling → structured TMDB filters), `core/tmdb_client.py` (Discover + movie details + enrichment). |
| 2026-02-19 | BUILD | Walking Skeleton — micro-tests | **5/5 PASS.** All moods correctly translated to filters. Comedy (35), Horror (27), Action (28), Romance (10749), Sci-Fi\|Thriller (878\|53). Constraints (runtime, sort) respected. Avg latency 2.5s. Skeleton Check: Riskiest Assumption HOLDS. |
| 2026-02-21 | BUILD | Scope 1 — full pipeline | Added watch providers enrichment, GPT-4o-mini ranking (20→5) with "why this matches" explanations, poster URLs. Function calling for structured filters. **6/6 PASS.** |
| 2026-02-21 | BUILD | Scope 2 — deploy backend | Created Procfile + render.yaml. Deployed FastAPI on Render (Python 3.11). Fixed: OpenAI quota error (429), added error handling (try/catch → 502 with message). Backend URL: `https://watchnext-flta.onrender.com` |
| 2026-02-21 | BUILD | Scope 2 — Lovable frontend | Built React/Tailwind frontend in Lovable. 3 prompts iteratifs. Empty state: poster wall background + mood chips. Results: 5 posters horizontal (desktop), 2-col grid (mobile). Detail view: poster + info + streaming badges (desktop: full page, mobile: bottom sheet). Loading: Lottie popcorn + progress bar + movie fun facts. Design: Linear meets cinema — dark monochrome UI, indigo accent, posters = the color. |
| 2026-02-22 | BUILD | Scope 2 — micro-tests | **8/8 PASS.** Deploy OK, E2E OK, posters OK, streaming badges OK, loading OK, empty state OK, mobile OK, usability OK. Produit demo-ready. |
| 2026-02-23 | EVALUATE | Round 1 — Golden dataset (10 queries) + Wild tests (3) | **NO-GO.** G1 9/10 (E8 Korean FAIL), G2 44/50 (E8 0/5 + E7 4/5), G3 2.70 avg PASS. 5 bugs: F1 language schema gap (E8+W1), F2 dedup (E2), F3 genre precision (E7), F4 animation bias (SIGNAL), F5 cast schema gap (W3). Root cause: `parse_mood` schema trop etroit — gere genres + providers mais PAS langue, acteur. |
| 2026-02-23 | BUILD | Micro-loop — 5 fixes (f29e331) | F1: `with_original_language` ajoute au schema + TMDB param. F2: dedup par movie_id dans recommender. F3+F4: curator prompt renforce (genre precision + diversite). F5: `with_cast_names` + `search_person()` + resolution noms→IDs. Bonus: cleanup null/empty strings. Tous testes localement PASS. |
| 2026-02-23 | EVALUATE | Round 2 — Re-evaluation post micro-loop | **CONDITIONAL GO.** E8 Korean 3-3-3-3-3, W1 French 3-3-3-2-3, W3 Brad Pitt 3-3-3-3-3, E2 0 doublon 3-3-3-3-3. G1 10/10, G2 49/50, G3 2.78 avg. Conditions: animation bias (SIGNAL), langue≠pays (TMDB limitation). |
